<?xml version="1.0" encoding="utf-8"?>
<DTS:Executable DTS:CreationDate="07/27/2018 14:32:35" DTS:CreationName="Microsoft.Package" DTS:CreatorComputerName="FDONB044" DTS:CreatorName="beek" DTS:DTSID="{4C5D256D-F7C0-4889-B3C5-C71569F1723E}" DTS:ExecutableType="Microsoft.Package" DTS:LastModifiedProductVersion="" DTS:LocaleID="1043" DTS:ObjectName="Reports-RT-INTRASTAT" DTS:ProtectionLevel="0" DTS:refId="Package" DTS:VersionBuild="0" DTS:VersionGUID="{6EA43149-C1F2-4CB3-A27F-63A623B9E5C2}" DTS:VersionMajor="0" xmlns:DTS="www.microsoft.com/SqlServer/Dts">
  <DTS:Property DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:PackageParameters>
    <DTS:PackageParameter DTS:CreationName="" DTS:DataType="20" DTS:Description="" DTS:DTSID="{18A07D32-19FA-4242-9BFE-D7660ADA1478}" DTS:ObjectName="BatchID" DTS:Required="0" DTS:Sensitive="0">
      <DTS:Property DTS:DataType="20" DTS:Name="ParameterValue">-1</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter DTS:CreationName="" DTS:DataType="20" DTS:Description="" DTS:DTSID="{186EC5E0-0D6B-4239-AB1E-475F8E3A9A55}" DTS:ObjectName="ProcessLogParentID" DTS:Required="0" DTS:Sensitive="0">
      <DTS:Property DTS:DataType="20" DTS:Name="ParameterValue">0</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{48051488-4037-4484-AC6A-7C26789893B4}" DTS:IncludeInDebugDump="2345" DTS:Namespace="Audit" DTS:ObjectName="AuditActionStart">
      <DTS:VariableValue DTS:DataType="8">S</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{7F029168-4F10-4DD5-A6E8-93DBFCF26C64}" DTS:IncludeInDebugDump="2345" DTS:Namespace="Audit" DTS:ObjectName="AuditBatchActionNone">
      <DTS:VariableValue DTS:DataType="8">N</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{538B1478-C928-41E4-9C18-C41DD38282E3}" DTS:IncludeInDebugDump="2345" DTS:Namespace="Audit" DTS:ObjectName="AuditActionFinish">
      <DTS:VariableValue DTS:DataType="8">F</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{2F6F5BAB-4F0E-4F18-BA6C-FEFF7BCD522F}" DTS:IncludeInDebugDump="2345" DTS:Namespace="Audit" DTS:ObjectName="AuditActionError">
      <DTS:VariableValue DTS:DataType="8">E</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{B5EDDD14-0FE0-4A47-850D-0A76D54E2FE1}" DTS:IncludeInDebugDump="6789" DTS:Namespace="Audit" DTS:ObjectName="AuditProcessLogID">
      <DTS:VariableValue DTS:DataType="20">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{08322E38-ADBF-4AA2-B5EB-AC7C9CA2BCEB}" DTS:IncludeInDebugDump="6789" DTS:Namespace="Audit" DTS:ObjectName="AuditBatchID">
      <DTS:VariableValue DTS:DataType="20">-1</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{52F46335-C022-4796-A91B-363C75615AFF}" DTS:IncludeInDebugDump="2345" DTS:Namespace="User" DTS:ObjectName="PackageName">
      <DTS:VariableValue DTS:DataType="8">Reports-RT-INTRASTAT</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{E7A7B275-3902-445F-B7D3-F55E0C34161C}" DTS:IncludeInDebugDump="6789" DTS:Namespace="RC" DTS:ObjectName="RowCountExtract">
      <DTS:VariableValue DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{74D7F1CB-FA08-464E-8F14-6DEACA21881D}" DTS:IncludeInDebugDump="6789" DTS:Namespace="RC" DTS:ObjectName="RowCountTarget">
      <DTS:VariableValue DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{779CB241-B51A-4B81-A933-BADB2EDC2516}" DTS:IncludeInDebugDump="6789" DTS:Namespace="RC" DTS:ObjectName="RowCountError">
      <DTS:VariableValue DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{7D7DFB87-EE2F-455C-9A9E-66C2C31EA438}" DTS:IncludeInDebugDump="2345" DTS:Namespace="User" DTS:ObjectName="LastExtractionDate">
      <DTS:VariableValue DTS:DataType="8">2000-01-01 00:00:00</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{89B25DB5-A528-4554-8E91-613679215D6F}" DTS:IncludeInDebugDump="2345" DTS:Namespace="User" DTS:ObjectName="ExtractionType">
      <DTS:VariableValue DTS:DataType="8">F</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{48D045EC-E34C-4EF5-9435-ECA4B8F86463}" DTS:IncludeInDebugDump="2345" DTS:Namespace="User" DTS:ObjectName="SourceExtractionSQL">
      <DTS:VariableValue DTS:DataType="8">SELECT * FROM [RT].[INTRASTAT]</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable DTS:CreationName="" DTS:DTSID="{68CF3DDE-3CE8-4A84-A802-11E95BEB3D3E}" DTS:IncludeInDebugDump="2345" DTS:Namespace="User" DTS:ObjectName="SelectionDate">
      <DTS:VariableValue DTS:DataType="8">2000-01-01 00:00:00</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{990E52B4-9102-4797-AE36-5524FA86DD37}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Start Audit Package Reports-RT-INTRASTAT" DTS:refId="Package\SQL Start Audit Package Reports-RT-INTRASTAT" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:ObjectData>
        <SQLTask:SqlTaskData SQLTask:Connection="DWH_Control" SQLTask:ResultType="ResultSetType_SingleRow" SQLTask:SqlStatementSource="EXECUTE [Logging].[PrcLoggingPackageExecution] @Action = ?,@BatchAction = ?,@BatchID = ?,@ProcessLogParentID = ?,@ProcessLogID = ?,@PackageName = ?,@SysPkgID = ?,@SysPkgName = ?,@SysPkgVersionGUID = ? ,@SysPkgVersionMajor = ?,@SysPkgVersionMinor = ?,@SysPkgExecutionMachineName = ?,@SysPkgExecutionUserName = ?,@SysPkgExecutionInstanceGUID = ?,@ExtractionType = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="Audit::AuditActionStart" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="0" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="Audit::AuditBatchActionNone" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="1" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="20" SQLTask:DtsVariableName="$Package::BatchID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="2" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="20" SQLTask:DtsVariableName="$Package::ProcessLogParentID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="3" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="20" SQLTask:DtsVariableName="Audit::AuditProcessLogID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="4" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="User::PackageName" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="5" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="System::PackageID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="6" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="System::PackageName" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="7" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="System::VersionGUID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="8" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="3" SQLTask:DtsVariableName="System::VersionMajor" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="9" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="3" SQLTask:DtsVariableName="System::VersionMinor" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="10" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="System::MachineName" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="11" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="System::UserName" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="12" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="System::ExecutionInstanceGUID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="13" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="User::ExtractionType" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="14" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ResultBinding SQLTask:DtsVariableName="Audit::AuditBatchID" SQLTask:ResultName="0"></SQLTask:ResultBinding>
          <SQLTask:ResultBinding SQLTask:DtsVariableName="Audit::AuditProcessLogID" SQLTask:ResultName="1"></SQLTask:ResultBinding>
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable DTS:CreationName="STOCK:SEQUENCE" DTS:DTSID="{C566A2FB-C80D-4039-AB46-D50171AAB7B9}" DTS:ExecutableType="STOCK:SEQUENCE" DTS:LocaleID="-1" DTS:ObjectName="SC Load Reports-RT-INTRASTAT" DTS:refId="Package\SC Load Reports-RT-INTRASTAT">
      <DTS:Executables>
        <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{AB096BD0-D22A-40C5-9B9D-0E1918975155}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Get last extraction date Reports-RT-INTRASTAT" DTS:refId="Package\SC Load Reports-RT-INTRASTAT\SQL Get last extraction date Reports-RT-INTRASTAT" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:ObjectData>
            <SQLTask:SqlTaskData SQLTask:Connection="DWH_Control" SQLTask:ResultType="ResultSetType_SingleRow" SQLTask:SqlStatementSource="SELECT CONVERT(VARCHAR, MAX([LastLoadDate]), 120) &#xA;FROM [Control].[DWHControl] &#xA;WHERE [SourceConnection] = 'Reports' &#xA;AND [SourceSchema] = 'RT' &#xA;AND [SourceTable] = 'INTRASTAT'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding SQLTask:DtsVariableName="User::LastExtractionDate" SQLTask:ResultName="0"></SQLTask:ResultBinding>
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{C0DAA025-FDBA-48A1-A48D-97F0C3950029}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Source row count Reports-RT-INTRASTAT" DTS:refId="Package\SC Load Reports-RT-INTRASTAT\SQL Source row count Reports-RT-INTRASTAT" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:ObjectData>
            <SQLTask:SqlTaskData SQLTask:Connection="Reports" SQLTask:ResultType="ResultSetType_SingleRow" SQLTask:SqlStatementSource="SELECT count(*) FROM [Reports].[RT].[INTRASTAT]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding SQLTask:DtsVariableName="RC::RowCountExtract" SQLTask:ResultName="0"></SQLTask:ResultBinding>
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{3F9022BF-82E7-4D3B-A2F3-7892909904D6}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Merge Reports-RT-INTRASTAT" DTS:refId="Package\SC Load Reports-RT-INTRASTAT\SQL Merge Reports-RT-INTRASTAT" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:ObjectData>
            <SQLTask:SqlTaskData SQLTask:Connection="Reports" SQLTask:SqlStatementSource="DECLARE @INTRASTAT_TEMP TABLE ([INTRASTAT_ID][int] NULL,[TRANSACTION_ID][int] NULL,[TRANSACTION][nvarchar] (10) NULL,[ORDER_TYPE][nvarchar] (4000) NULL,[CONTRACT][nvarchar] (5) NULL,[COMPONENT_PART][nvarchar] (25) NULL,[DESCRIPTION][nvarchar] (200) NULL,[ORDER_REF1][nvarchar] (12) NULL,[QUANTITY][int] NULL,[PRINT_UNIT][nvarchar] (30) NULL,[DATE_APPLIED][datetime2] (7) NULL,[WEIGHT_NET][int] NULL,[CUSTOMS_STAT_NO][nvarchar] (10) NULL,[INTRASTAT_ALT_QTY][int] NULL,[INTRASTAT_ALT_UNIT_MEAS][nvarchar] (10) NULL,[INTRASTAT_DIRECTION][nvarchar] (4000) NULL,[COUNTRY_OF_ORIGIN][nvarchar] (2) NULL,[INTRASTAT_ORIGIN][nvarchar] (4000) NULL,[OPPOSITE_COUNTRY][nvarchar] (2) NULL,[OPPONENT_NUMBER][nvarchar] (20) NULL,[OPPONENT_NAME][nvarchar] (4000) NULL,[ORDER_UNIT_PRICE][int] NULL,[UNIT_ADD_COST_AMOUNT][int] NULL,[UNIT_CHARGE_AMOUNT][int] NULL,[MODE_OF_TRANSPORT][nvarchar] (4000) NULL,[INVOICE_SERIE][nvarchar] (20) NULL,[INVOICE_NUMBER][nvarchar] (50) NULL,[SALE_UNIT_PRICE][int] NULL,[INVOICED_AMOUNT][int] NULL,[COUNTRY_CODE][nvarchar] (4000) NULL,INSERT INTO @INTRASTAT_TEMP SELECT [INTRASTAT_ID], [TRANSACTION_ID], [TRANSACTION], [ORDER_TYPE], [CONTRACT], [COMPONENT_PART], [DESCRIPTION], [ORDER_REF1], [QUANTITY], [PRINT_UNIT], [DATE_APPLIED], [WEIGHT_NET], [CUSTOMS_STAT_NO], [INTRASTAT_ALT_QTY], [INTRASTAT_ALT_UNIT_MEAS], [INTRASTAT_DIRECTION], [COUNTRY_OF_ORIGIN], [INTRASTAT_ORIGIN], [OPPOSITE_COUNTRY], [OPPONENT_NUMBER], [OPPONENT_NAME], [ORDER_UNIT_PRICE], [UNIT_ADD_COST_AMOUNT], [UNIT_CHARGE_AMOUNT], [MODE_OF_TRANSPORT], [INVOICE_SERIE], [INVOICE_NUMBER], [SALE_UNIT_PRICE], [INVOICED_AMOUNT], [COUNTRY_CODE], FROM (MERGE Reports.RT.INTRASTAT T &#xA;                                                                         USING Staging.RT.INTRASTAT S &#xA;                                                                         ON  1=1 AND  T.ActInd = 'Y' AND T.IsDeleted = 'N' &#xA;                                                                         WHEN NOT MATCHED BY TARGET THEN INSERT VALUES ( [INTRASTAT_ID], [TRANSACTION_ID], [TRANSACTION], [ORDER_TYPE], [CONTRACT], [COMPONENT_PART], [DESCRIPTION], [ORDER_REF1], [QUANTITY], [PRINT_UNIT], [DATE_APPLIED], [WEIGHT_NET], [CUSTOMS_STAT_NO], [INTRASTAT_ALT_QTY], [INTRASTAT_ALT_UNIT_MEAS], [INTRASTAT_DIRECTION], [COUNTRY_OF_ORIGIN], [INTRASTAT_ORIGIN], [OPPOSITE_COUNTRY], [OPPONENT_NUMBER], [OPPONENT_NAME], [ORDER_UNIT_PRICE], [UNIT_ADD_COST_AMOUNT], [UNIT_CHARGE_AMOUNT], [MODE_OF_TRANSPORT], [INVOICE_SERIE], [INVOICE_NUMBER], [SALE_UNIT_PRICE], [INVOICED_AMOUNT], [COUNTRY_CODE],  GETDATE()-1, '31-DEC-9999', 'Y','N', ? , ? )  WHEN MATCHED &#xA;                                                                         AND ( (SELECT SUBSTRING(HashBytes('MD5', ISNULL(CAST(S.[INTRASTAT_ID] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[TRANSACTION_ID] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[TRANSACTION] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[ORDER_TYPE] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[CONTRACT] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[COMPONENT_PART] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[DESCRIPTION] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[ORDER_REF1] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[QUANTITY] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[PRINT_UNIT] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[DATE_APPLIED] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[WEIGHT_NET] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[CUSTOMS_STAT_NO] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[INTRASTAT_ALT_QTY] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[INTRASTAT_ALT_UNIT_MEAS] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[INTRASTAT_DIRECTION] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[COUNTRY_OF_ORIGIN] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[INTRASTAT_ORIGIN] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[OPPOSITE_COUNTRY] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[OPPONENT_NUMBER] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[OPPONENT_NAME] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[ORDER_UNIT_PRICE] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[UNIT_ADD_COST_AMOUNT] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[UNIT_CHARGE_AMOUNT] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[MODE_OF_TRANSPORT] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[INVOICE_SERIE] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[INVOICE_NUMBER] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[SALE_UNIT_PRICE] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[INVOICED_AMOUNT] AS VARCHAR(100)),'') +  ISNULL(CAST(S.[COUNTRY_CODE] AS VARCHAR(100)),'') + ''), 3, 32))   &lt;&gt; (SELECT SUBSTRING(HashBytes('MD5', ISNULL(CAST(T.[INTRASTAT_ID] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[TRANSACTION_ID] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[TRANSACTION] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[ORDER_TYPE] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[CONTRACT] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[COMPONENT_PART] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[DESCRIPTION] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[ORDER_REF1] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[QUANTITY] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[PRINT_UNIT] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[DATE_APPLIED] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[WEIGHT_NET] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[CUSTOMS_STAT_NO] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[INTRASTAT_ALT_QTY] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[INTRASTAT_ALT_UNIT_MEAS] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[INTRASTAT_DIRECTION] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[COUNTRY_OF_ORIGIN] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[INTRASTAT_ORIGIN] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[OPPOSITE_COUNTRY] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[OPPONENT_NUMBER] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[OPPONENT_NAME] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[ORDER_UNIT_PRICE] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[UNIT_ADD_COST_AMOUNT] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[UNIT_CHARGE_AMOUNT] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[MODE_OF_TRANSPORT] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[INVOICE_SERIE] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[INVOICE_NUMBER] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[SALE_UNIT_PRICE] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[INVOICED_AMOUNT] AS VARCHAR(100)),'') +  ISNULL(CAST(T.[COUNTRY_CODE] AS VARCHAR(100)),'') + ''), 3, 32))   OR T.IsDeleted = 'Y') &#xA;                                                                          THEN UPDATE SET T.ActInd = 'N' , T.End_Date = GETDATE()-2 &#xA;                                                                         WHEN NOT MATCHED BY SOURCE AND  T.ActInd = 'Y'  AND T.IsDeleted &lt;&gt; 'Y'  &#xA;                                                                          THEN UPDATE SET T.ActInd = 'N' , T.IsDeleted = 'Y' , T.End_Date     =  GETDATE()-2 OUTPUT $action   AS action, &#xA;                                                                         S.[INTRASTAT_ID], S.[TRANSACTION_ID], S.[TRANSACTION], S.[ORDER_TYPE], S.[CONTRACT], S.[COMPONENT_PART], S.[DESCRIPTION], S.[ORDER_REF1], S.[QUANTITY], S.[PRINT_UNIT], S.[DATE_APPLIED], S.[WEIGHT_NET], S.[CUSTOMS_STAT_NO], S.[INTRASTAT_ALT_QTY], S.[INTRASTAT_ALT_UNIT_MEAS], S.[INTRASTAT_DIRECTION], S.[COUNTRY_OF_ORIGIN], S.[INTRASTAT_ORIGIN], S.[OPPOSITE_COUNTRY], S.[OPPONENT_NUMBER], S.[OPPONENT_NAME], S.[ORDER_UNIT_PRICE], S.[UNIT_ADD_COST_AMOUNT], S.[UNIT_CHARGE_AMOUNT], S.[MODE_OF_TRANSPORT], S.[INVOICE_SERIE], S.[INVOICE_NUMBER], S.[SALE_UNIT_PRICE], S.[INVOICED_AMOUNT], S.[COUNTRY_CODE],  GETDATE()-1 AS Eff_Date , '31-DEC-9999' AS End_Date  , 'Y' AS ActInd , &#xA;                                                                         CASE WHEN S.BatchID IS NULL THEN 'Y' ELSE 'N' END AS IsDeleted, ? AS BatchID, ? as ProcessLogID ) AS MERGE_OUT &#xA;                                                                         WHERE MERGE_OUT.action = 'UPDATE' AND IsDeleted &lt;&gt; 'Y'; INSERT INTO  Reports.RT.INTRASTAT SELECT * FROM @INTRASTAT_TEMP;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding SQLTask:DataType="20" SQLTask:DtsVariableName="Audit::AuditBatchID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="0" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
              <SQLTask:ParameterBinding SQLTask:DataType="20" SQLTask:DtsVariableName="Audit::AuditProcessLogID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="1" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
              <SQLTask:ParameterBinding SQLTask:DataType="20" SQLTask:DtsVariableName="Audit::AuditBatchID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="2" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
              <SQLTask:ParameterBinding SQLTask:DataType="20" SQLTask:DtsVariableName="Audit::AuditProcessLogID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="3" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{4793D6CE-E22F-4766-981B-471DC63DAE5A}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Target row count Reports-RT-INTRASTAT" DTS:refId="Package\SC Load Reports-RT-INTRASTAT\SQL Target row count Reports-RT-INTRASTAT" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:ObjectData>
            <SQLTask:SqlTaskData SQLTask:Connection="Reports" SQLTask:ResultType="ResultSetType_SingleRow" SQLTask:SqlStatementSource="SELECT count(*) FROM [RT].[INTRASTAT]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding SQLTask:DtsVariableName="RC::RowCountTarget" SQLTask:ResultName="0"></SQLTask:ResultBinding>
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{3B319095-9F12-4F46-A9D0-6EAFF0883BB9}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Update contol record Reports-RT-INTRASTAT" DTS:refId="Package\SC Load Reports-RT-INTRASTAT\SQL Update contol record Reports-RT-INTRASTAT" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:ObjectData>
            <SQLTask:SqlTaskData SQLTask:Connection="DWH_Control" SQLTask:SqlStatementSource="MERGE [Control].[DWHControl] T   &#xA; USING (Select 'Reports' as [SourceConnection] &#xA; , 'RT' as [SourceSchema] &#xA; , 'INTRASTAT' as [SourceTable] &#xA; , 'F' as [ExtractionType] &#xA; , ? as [BatchID]  &#xA; , ? as [RowCountExtract]  &#xA; , ? as [RowCountTarget]  &#xA; , ? as [RowCountError]  &#xA; , ? as [LastLoadDate]  &#xA; ) S  &#xA; ON  T.[SourceConnection] = S.[SourceConnection] AND  T.[SourceSchema] = S.[SourceSchema]  AND T.[SourceTable] = S.[SourceTable]  &#xA; WHEN NOT MATCHED BY TARGET THEN INSERT VALUES ( S.[SourceConnection] &#xA; , S.[SourceSchema] &#xA; , S.[SourceTable] &#xA; , S.[ExtractionType] &#xA; , S.[BatchID] &#xA; , S.[RowCountExtract] &#xA; , S.[RowCountTarget] &#xA; , S.[RowCountError] &#xA; , S.[LastLoadDate]   )   &#xA; WHEN MATCHED  THEN &#xA; UPDATE &#xA; SET &#xA;  [ExtractionType] = S.[ExtractionType] &#xA; , [BatchID] = S.[BatchID] &#xA; , [RowCountExtract] = S.[RowCountExtract] &#xA; , [RowCountTarget] = S.[RowCountTarget] &#xA; , [RowCountError] = S.[RowCountError] &#xA; , [LastLoadDate] = S.[LastLoadDate] ;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding SQLTask:DataType="20" SQLTask:DtsVariableName="$Package::BatchID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="0" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
              <SQLTask:ParameterBinding SQLTask:DataType="3" SQLTask:DtsVariableName="RC::RowCountExtract" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="1" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
              <SQLTask:ParameterBinding SQLTask:DataType="3" SQLTask:DtsVariableName="RC::RowCountTarget" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="2" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
              <SQLTask:ParameterBinding SQLTask:DataType="3" SQLTask:DtsVariableName="RC::RowCountError" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="3" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
              <SQLTask:ParameterBinding SQLTask:DataType="7" SQLTask:DtsVariableName="System::StartTime" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="4" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint DTS:CreationName="" DTS:DTSID="{24C4B828-F07F-449E-AC34-CE41255D0307}" DTS:From="Package\SC Load Reports-RT-INTRASTAT\SQL Get last extraction date Reports-RT-INTRASTAT" DTS:LogicalAnd="True" DTS:ObjectName="Constraint_SQL Get last extraction date Reports-RT-INTRASTAT_To_SQL Source row count Reports-RT-INTRASTAT" DTS:refId="Package\SC Load Reports-RT-INTRASTAT.PrecedenceConstraints[Constraint_SQL Get last extraction date Reports-RT-INTRASTAT_To_SQL Source row count Reports-RT-INTRASTAT]" DTS:To="Package\SC Load Reports-RT-INTRASTAT\SQL Source row count Reports-RT-INTRASTAT"></DTS:PrecedenceConstraint>
        <DTS:PrecedenceConstraint DTS:CreationName="" DTS:DTSID="{A5B1EE2D-A6F8-4A44-B897-3ED9CFCBBA0F}" DTS:From="Package\SC Load Reports-RT-INTRASTAT\SQL Source row count Reports-RT-INTRASTAT" DTS:LogicalAnd="True" DTS:ObjectName="Constraint_SQL Source row count Reports-RT-INTRASTAT_To_SQL Merge Reports-RT-INTRASTAT" DTS:refId="Package\SC Load Reports-RT-INTRASTAT.PrecedenceConstraints[Constraint_SQL Source row count Reports-RT-INTRASTAT_To_SQL Merge Reports-RT-INTRASTAT]" DTS:To="Package\SC Load Reports-RT-INTRASTAT\SQL Merge Reports-RT-INTRASTAT"></DTS:PrecedenceConstraint>
        <DTS:PrecedenceConstraint DTS:CreationName="" DTS:DTSID="{701F8FEA-C30F-4E07-8F5A-7F11B83F803F}" DTS:From="Package\SC Load Reports-RT-INTRASTAT\SQL Merge Reports-RT-INTRASTAT" DTS:LogicalAnd="True" DTS:ObjectName="Constraint_SQL Merge Reports-RT-INTRASTAT_To_SQL Target row count Reports-RT-INTRASTAT" DTS:refId="Package\SC Load Reports-RT-INTRASTAT.PrecedenceConstraints[Constraint_SQL Merge Reports-RT-INTRASTAT_To_SQL Target row count Reports-RT-INTRASTAT]" DTS:To="Package\SC Load Reports-RT-INTRASTAT\SQL Target row count Reports-RT-INTRASTAT"></DTS:PrecedenceConstraint>
        <DTS:PrecedenceConstraint DTS:CreationName="" DTS:DTSID="{C443E428-BA83-4EE4-B5D6-ACCD5CDF3F9D}" DTS:From="Package\SC Load Reports-RT-INTRASTAT\SQL Target row count Reports-RT-INTRASTAT" DTS:LogicalAnd="True" DTS:ObjectName="Constraint_SQL Target row count Reports-RT-INTRASTAT_To_SQL Update contol record Reports-RT-INTRASTAT" DTS:refId="Package\SC Load Reports-RT-INTRASTAT.PrecedenceConstraints[Constraint_SQL Target row count Reports-RT-INTRASTAT_To_SQL Update contol record Reports-RT-INTRASTAT]" DTS:To="Package\SC Load Reports-RT-INTRASTAT\SQL Update contol record Reports-RT-INTRASTAT"></DTS:PrecedenceConstraint>
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
    <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{27F88A42-787B-4636-805E-9DF042C81A74}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Finish Audit Package Reports-RT-INTRASTAT" DTS:refId="Package\SQL Finish Audit Package Reports-RT-INTRASTAT" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:ObjectData>
        <SQLTask:SqlTaskData SQLTask:Connection="DWH_Control" SQLTask:SqlStatementSource="EXECUTE [Logging].[PrcLoggingPackageExecution] @Action = ?,@BatchAction = ?,@BatchID = ?,@ProcessLogID = ?,@LastExtractionDate = ?,@RowCountExtract = ?,@RowCountTarget = ?,@RowCountError = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="Audit::AuditActionFinish" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="0" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="Audit::AuditBatchActionNone" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="1" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="20" SQLTask:DtsVariableName="Audit::AuditBatchID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="2" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="20" SQLTask:DtsVariableName="Audit::AuditProcessLogID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="3" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="User::LastExtractionDate" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="4" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="3" SQLTask:DtsVariableName="RC::RowCountExtract" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="5" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="3" SQLTask:DtsVariableName="RC::RowCountTarget" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="6" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
          <SQLTask:ParameterBinding SQLTask:DataType="3" SQLTask:DtsVariableName="RC::RowCountError" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="7" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint DTS:CreationName="" DTS:DTSID="{BCC1F9BA-446F-4EB8-8527-50772FF415CE}" DTS:From="Package\SQL Start Audit Package Reports-RT-INTRASTAT" DTS:LogicalAnd="True" DTS:ObjectName="Constraint_SQL Start Audit Package Reports-RT-INTRASTAT_To_SC Load Reports-RT-INTRASTAT" DTS:refId="Package.PrecedenceConstraints[Constraint_SQL Start Audit Package Reports-RT-INTRASTAT_To_SC Load Reports-RT-INTRASTAT]" DTS:To="Package\SC Load Reports-RT-INTRASTAT"></DTS:PrecedenceConstraint>
    <DTS:PrecedenceConstraint DTS:CreationName="" DTS:DTSID="{8CC9B07D-92AB-4A5F-8C87-83B3E6639BAC}" DTS:From="Package\SC Load Reports-RT-INTRASTAT" DTS:LogicalAnd="True" DTS:ObjectName="Constraint_SC Load Reports-RT-INTRASTAT_To_SQL Finish Audit Package Reports-RT-INTRASTAT" DTS:refId="Package.PrecedenceConstraints[Constraint_SC Load Reports-RT-INTRASTAT_To_SQL Finish Audit Package Reports-RT-INTRASTAT]" DTS:To="Package\SQL Finish Audit Package Reports-RT-INTRASTAT"></DTS:PrecedenceConstraint>
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler DTS:CreationName="OnError" DTS:DTSID="{0976598D-E98C-4228-A906-FB4F5E5AD438}" DTS:EventID="0" DTS:EventName="OnError" DTS:LocaleID="-1" DTS:refId="Package.EventHandlers[OnError]">
      <DTS:Executables>
        <DTS:Executable DTS:CreationName="Microsoft.ExecuteSQLTask" DTS:DTSID="{9F393307-3E4B-4755-B7C2-A36658C354C4}" DTS:ExecutableType="Microsoft.ExecuteSQLTask" DTS:LocaleID="-1" DTS:ObjectName="SQL Error Audit Package Reports-RT-INTRASTAT" DTS:refId="Package.EventHandlers[OnError]\SQL Error Audit Package Reports-RT-INTRASTAT" DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:ObjectData>
            <SQLTask:SqlTaskData SQLTask:Connection="DWH_Control" SQLTask:SqlStatementSource="exec [Logging].[PrcLogMessage]@ProcessLogID = ?,@BatchID = ?,@SourceName = ?,@EventCode = ?,@EventDescription = ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding SQLTask:DataType="20" SQLTask:DtsVariableName="Audit::AuditProcessLogID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="0" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
              <SQLTask:ParameterBinding SQLTask:DataType="20" SQLTask:DtsVariableName="Audit::AuditBatchID" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="1" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
              <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="System::PackageName" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="2" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
              <SQLTask:ParameterBinding SQLTask:DataType="3" SQLTask:DtsVariableName="System::ErrorCode" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="3" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
              <SQLTask:ParameterBinding SQLTask:DataType="130" SQLTask:DtsVariableName="System::ErrorDescription" SQLTask:ParameterDirection="Input" SQLTask:ParameterName="4" SQLTask:ParameterSize="0"></SQLTask:ParameterBinding>
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:Variables>
        <DTS:Variable DTS:CreationName="" DTS:Description="The propagate property of the event" DTS:DTSID="{F53E447B-5DFD-4431-9DA4-050B0D375590}" DTS:IncludeInDebugDump="6789" DTS:Namespace="System" DTS:ObjectName="Propagate">
          <DTS:VariableValue DTS:DataType="11">True</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
    </DTS:EventHandler>
  </DTS:EventHandlers>
</DTS:Executable>